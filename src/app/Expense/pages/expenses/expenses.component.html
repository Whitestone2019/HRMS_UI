<div class="expenses-page">
    <div class="page-header">
        <div class="header-content">
            <!-- <div *ngIf="showFullTable" class="back-button-container">
                <button (click)="showInitialView()" class="back-button">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
            </div> -->
            <div>
                <h2>Expenses</h2>
            </div>
            <div class="header-controls">
                <select (click)="$event.stopPropagation()" class="filter-dropdown" (change)="applyFilter()"
                    [(ngModel)]="filterStatus" (ngModelChange)="applyFilter()">
                    <option value="all">All Requests</option>
                    <option value="pending">Pending</option>
                    <option value="Payment To Be Initiate">Payment To Be Initiate</option>
                    <option value="Payment Initiated">Payment Initiated</option>
                    <option value="Payment Done">Payment Done</option>
                    <option value="rejected">Rejected</option>
                </select>
                <!-- <input *ngIf="!showFullTable" type="text" placeholder="Search Pending Employee"
                    [(ngModel)]="searchQuery" (ngModelChange)="applyFilter()" class="search-input" />
                <input *ngIf="showFullTable && !isSpecificEmployeeView" type="text" placeholder="Search by EmpID"
                    [(ngModel)]="searchEmpId" (ngModelChange)="applyFilter()" class="search-input" />
                <input *ngIf="showFullTable && !isSpecificEmployeeView" type="text" placeholder="Search by EmpName"
                    [(ngModel)]="searchEmpName" (ngModelChange)="applyFilter()" class="search-input" /> -->
                <button *ngIf="!isSpecificEmployeeView" class="btn-primary" routerLink="/expences/dashboardexp/new">
                    <i class="fas fa-plus"></i> New Expense
                </button>
            </div>
        </div>
    </div>

    <!-- [ngStyle]="{ 
        display: 'flex', 
        width: '80%', 
        'justify-content': showFullTable ? 'center' : 'flex-start' 
      }" -->

    <!-- <div *ngIf="!showFullTable" class="pending-employees-section">
        <h3>Employees with {{filterStatus | titlecase}} Expenses</h3>
        <div class="employee-cards">
            <div *ngFor="let employee of pendingEmployees" class="employee-card">
                <div class="employee-id-container">
                    <div class="employee-id">
                        {{ employee.employeeName }} ({{ employee.empId }})
                    </div>
                    <div class="pending-badge">Pending</div>
                </div>
                <button (click)="showEmployeePending(employee.empId)" class="view-details-button">
                    <i class="fas fa-eye"></i> View Details
                </button>
            </div>
        </div>
        <button (click)="showAllExpenses()" class="view-all-expenses-button">
            <i class="fas fa-list"></i> View All Expenses
        </button>
    </div> -->

    <div *ngIf="showFullTable" class="expenses-list">
        <div class="list-header">
            <div class="header-empid">Empid</div>
            <div class="header-date">Date</div>
            <div class="header-merchant">Category/Description</div>
            <div class="header-amount">Amount</div>
            <div class="header-status">Status</div>
            <div class="col-file">Reason</div>
            <div class="header-actions">Actions</div>
        </div>
        <div *ngFor="let expense of pagedExpenses" class="expense-item">
            <div class="item-empid">
                <span class="empid">{{ expense.empId }}</span>
            </div>
            <div class="item-date">
                {{ expense.date}}
            </div>
            <div class="item-details">
                <span class="category">{{ expense.category }}</span>
                <span class="description">{{ expense.description }}</span>
            </div>
            <div class="item-amount">
                {{ expense.currency }} {{ expense.amount | number: '1.2-2' }}
            </div>
            <div class="item-status">
                <span class="status-badge" [ngClass]="getStatusClass(expense.status)">
                    {{ expense.status | titlecase }}
                  </span>
                <!-- <span class="status-badge" [class]="expense.status">
                    {{ expense.status | titlecase }}
                </span> -->
            </div>
            <div class="col-file">{{ expense.rejectreason }}</div>
            <div class="item-actions">
                <button *ngIf="expense.status !== 'pending'" class="btn-icon" (click)="viewExpense(expense)" title="View">
                  <i class="fas fa-eye"></i>
                </button>
                <button *ngIf="expense.status === 'pending'" class="btn-icon" (click)="onEdit(expense)" title="Edit">
                  <i class="fas fa-edit"></i>
                </button>
                <button *ngIf="expense.status === 'pending'" class="btn-icon" (click)="onDelete(expense)" title="Delete">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
        </div>
        <div *ngIf="expenses.length === 0" class="no-expenses">
            <i class="fas fa-receipt fa-3x"></i>
            <p>No expenses found</p>
        </div>
    </div>

    <div *ngIf="showFullTable" class="pagination-controls">
        <button class="arrow-button" (click)="previousPage()" [disabled]="currentPage === 1">
            <i class="fas fa-chevron-left"></i>
        </button>
        <span class="page-number">{{ currentPage }} / {{ totalPages }}</span>
        <button class="arrow-button" (click)="nextPage()"
            [disabled]="currentPage * itemsPerPage >= filteredExpenses.length">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
    <div *ngIf="showFullTable && currentPage === 1" class="pagination-info">
        Total Records: {{ totalRecords }}, Total Pages: {{ totalPages }}
    </div>

</div>